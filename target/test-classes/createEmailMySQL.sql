DROP TABLE IF EXISTS TO_BRIDGE;
DROP TABLE IF EXISTS CC_BRIDGE;
DROP TABLE IF EXISTS BCC_BRIDGE;
DROP TABLE IF EXISTS BINARYFILES;
DROP TABLE IF EXISTS EMAILMESSAGE;
DROP TABLE IF EXISTS EMAIL;
DROP TABLE IF EXISTS EMAILADDRESS;
DROP TABLE IF EXISTS FOLDER;

CREATE TABLE FOLDER (
    FOLDER_ID int NOT NULL AUTO_INCREMENT,
    FOLDER_NAME varchar(50) NOT NULL UNIQUE,
    PRIMARY KEY(FOLDER_ID)
);

CREATE TABLE EMAIL (
    EMAIL_ID int NOT NULL AUTO_INCREMENT,
    EMAIL_FROM varchar(254) NOT NULL,
    EMAIL_SUBJECT varchar(255) NOT NULL default '',
    FOLDER_ID int NOT NULL default '0',
    SENT_DATE timestamp NULL,
    RECEIVED_DATE timestamp NULL,
    PRIMARY KEY(EMAIL_ID),
    FOREIGN KEY (FOLDER_ID) REFERENCES FOLDER(FOLDER_ID) ON DELETE CASCADE
);

CREATE TABLE BINARYFILES(
    FILE_ID int NOT NULL AUTO_INCREMENT,
    FILE_NAME varchar(255) NOT NULL default '',
    FILE_DATA mediumblob,
    EMAIL_ID int,
    CID varchar(255),
    PRIMARY KEY (FILE_ID),
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL(EMAIL_ID) ON DELETE CASCADE
);

CREATE TABLE EMAILADDRESS(
    EA_ID int NOT NULL AUTO_INCREMENT,
    EA_NAME varchar(255) NOT NULL UNIQUE,
    PRIMARY KEY (EA_ID)
);

CREATE TABLE EMAILMESSAGE(
    MESSAGE_ID int NOT NULL AUTO_INCREMENT,
    CONTENT TEXT NOT NULL,
    ENCODING VARCHAR(50) NOT NULL DEFAULT "",
    MIME varchar(50) NOT NULL DEFAULT "",
    EMAIL_ID int,
    PRIMARY KEY (MESSAGE_ID),
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL(EMAIL_ID) ON DELETE CASCADE
);

CREATE TABLE TO_BRIDGE(
    EA_ID int,
    EMAIL_ID int,
    PRIMARY KEY (EMAIL_ID, EA_ID),
    FOREIGN KEY (EA_ID) REFERENCES EMAILADDRESS(EA_ID),
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL(EMAIL_ID) ON DELETE CASCADE
    
);

CREATE TABLE CC_BRIDGE(
    EA_ID int,
    EMAIL_ID int,
    PRIMARY KEY (EMAIL_ID, EA_ID),
    FOREIGN KEY (EA_ID) REFERENCES EMAILADDRESS(EA_ID),
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL(EMAIL_ID) ON DELETE CASCADE
);

CREATE TABLE BCC_BRIDGE(
    EA_ID int,
    EMAIL_ID int,
    PRIMARY KEY (EMAIL_ID, EA_ID),
    FOREIGN KEY (EA_ID) REFERENCES EMAILADDRESS(EA_ID),
    FOREIGN KEY (EMAIL_ID) REFERENCES EMAIL(EMAIL_ID) ON DELETE CASCADE

);

INSERT INTO FOLDER (FOLDER_ID, FOLDER_NAME) VALUES (1, "Inbox");
INSERT INTO FOLDER (FOLDER_ID, FOLDER_NAME) VALUES(2, "Sent");
INSERT INTO FOLDER (FOLDER_ID, FOLDER_NAME) VALUES(3, "Spam");
INSERT INTO FOLDER (FOLDER_ID, FOLDER_NAME) VALUES (4, "Fun Stuff");


INSERT INTO EMAILADDRESS (EA_NAME) VALUES ("hipster@gmail.com");
INSERT INTO EMAILADDRESS (EA_NAME) VALUES ("superwalkurefan@gmail.com");
INSERT INTO EMAILADDRESS (EA_NAME) VALUES ("deltathaivun@gmail.com");
INSERT INTO EMAILADDRESS (EA_NAME) VALUES ("thaireceivecc1@gmail.com");


INSERT INTO EMAIL (EMAIL_FROM, EMAIL_SUBJECT, FOLDER_ID, SENT_DATE, RECEIVED_DATE) VALUES ("superwalkurefan@gmail.com", "Baka", 1, CURRENT_TIMESTAMP,CURRENT_TIMESTAMP);
INSERT INTO EMAIL (EMAIL_FROM, EMAIL_SUBJECT, FOLDER_ID, SENT_DATE, RECEIVED_DATE) VALUES ("deltathaivun@gmail.com", "Hello", 2, CURRENT_TIMESTAMP, null);
INSERT INTO EMAIL (EMAIL_FROM, EMAIL_SUBJECT, FOLDER_ID, SENT_DATE, RECEIVED_DATE) VALUES ("deltathaivun@gmail.com", "Seed Message", 2, CURRENT_TIMESTAMP, null);
INSERT INTO EMAIL (EMAIL_FROM, EMAIL_SUBJECT, FOLDER_ID, SENT_DATE, RECEIVED_DATE) VALUES ("thaireceivecc1@gmail.com", "Can you kick a can", 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);
INSERT INTO EMAIL (EMAIL_FROM, EMAIL_SUBJECT, FOLDER_ID, SENT_DATE, RECEIVED_DATE) VALUES ("thaireceivecc1@gmail.com", "Plz lol", 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

INSERT INTO TO_BRIDGE (EA_ID, EMAIL_ID) VALUES (3,1);
INSERT INTO TO_BRIDGE (EA_ID, EMAIL_ID) VALUES (2,2);
INSERT INTO TO_BRIDGE (EA_ID, EMAIL_ID) VALUES (4,3);
INSERT INTO TO_BRIDGE (EA_ID, EMAIL_ID) VALUES (3,4);
INSERT INTO TO_BRIDGE (EA_ID, EMAIL_ID) VALUES (3,5);

INSERT INTO EMAILMESSAGE (CONTENT, ENCODING, MIME, EMAIL_ID) VALUES ("<h3>HELLO HUMAN</h3>","UTF-8","text/html",1);
INSERT INTO EMAILMESSAGE (CONTENT, ENCODING, MIME, EMAIL_ID) VALUES ("<p>This is a message</p>","UTF-8","text/html",2);
INSERT INTO EMAILMESSAGE (CONTENT, ENCODING, MIME, EMAIL_ID) VALUES ("<h1>I am bored</h1><h3>Do Something</h3>","UTF-8","text/html",3);
INSERT INTO EMAILMESSAGE (CONTENT, ENCODING, MIME, EMAIL_ID) VALUES ("<h1>NyanNyanNyanNyanNyan</h1>","UTF-8","text/html",4);
INSERT INTO EMAILMESSAGE (CONTENT, ENCODING, MIME, EMAIL_ID) VALUES ("<p>Do not reply</p>","UTF-8","text/html",5);